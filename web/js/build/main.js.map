{"version":3,"sources":["app.js","admin.controller.js","listeRecette.controller.js","recette.controller.js","commentaires.js","images-h.js","images-v.js","ingredients.js","recette.js","story.js","titre.js","recette.service.js"],"names":["cookieStoryApp","angular","module","config","$stateProvider","$urlRouterProvider","otherwise","state","url","templateUrl","controller","resolve","Recettes","RecetteService","listeRecette","then","result","data","Tags","listeTags","Recette","$stateParams","getRecette","slug","filter","input","slice","reverse","$","document","ready","limitScrollTop","parseInt","offset","top","scrollTop","css","position","z-index","window","scroll","$scope","$state","Upload","recettes","tags","newRecette","go","modifierRecette","recette","deleteRecette","id","reload","deleteTag","tag","removeTag","saveTag","addTag","uploadPic","file","upload","method","response","success","image","path","picFile","undefined","console","log","evt","progress","Math","min","loaded","total","commentaires","countCommentaire","length","contenuText","contenuList","layout","addElement","element","contenu","pos","push","item","titre","positionEdition","deleteElement","splice","modifierElement","index","trierLayoutParPosition","monterElement","positionTmp","descendreElement","sort","elementA","elementB","addCommentaire","form","$valid","commentaire","pseudo","mail","website","recetteId","saveCommentaire","addRecette","saveRecette","addTagToRecette","removeTagFromRecette","tagA","tagB","shift","isNotSelectedTag","some","tagRecette","directive","restrict","replace","scope","elements","template","story","service","$http","this","get","post","delete"],"mappings":"AACA,GAAAA,gBAAAC,QAAAC,OAAA,kBAAA,YAAA,gBAEAF,gBAAAG,OAAA,SAAAC,eAAAC,oBAEAA,mBAAAC,UAAA,KAEAF,eAEAG,MAAA,QACAC,IAAA,IACAC,YAAA,kBACAC,WAAA,mBACAC,SACAC,SAAA,SAAAC,gBACA,MAAAA,gBAAAC,eAAAC,KAAA,SAAAC,QACA,MAAAA,QAAAC,QAGAC,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,WAKAV,MAAA,WACAC,IAAA,kBACAC,YAAA,qBACAC,WAAA,cACAC,SACAS,QAAA,SAAAC,aAAAR,gBACA,MAAAA,gBAAAS,WAAAD,aAAAE,MAAAR,KAAA,SAAAC,QACA,MAAAA,QAAAC,MACA,aAEA,eAIAC,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,WAKAV,MAAA,cACAC,IAAA,WACAC,YAAA,yBACAC,WAAA,cACAC,SACAS,QAAA,WACA,MAAA,OAEAF,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,WAKAV,MAAA,mBACAC,IAAA,uBACAC,YAAA,yBACAC,WAAA,cACAC,SACAS,QAAA,SAAAC,aAAAR,gBACA,MAAAA,gBAAAS,WAAAD,aAAAE,MAAAR,KAAA,SAAAC,QACA,MAAAA,QAAAC,MACA,aAEA,eAIAC,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,WAKAV,MAAA,gBACAC,IAAA,SACAC,YAAA,mBACAC,WAAA,mBACAC,SACAC,SAAA,SAAAC,gBACA,MAAAA,gBAAAC,eAAAC,KAAA,SAAAC,QACA,MAAAA,QAAAC,QAGAC,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,WAKAV,MAAA,cACAC,IAAA,cACAC,YAAA,wBACAC,WAAA,mBACAC,SACAC,SAAA,SAAAC,gBACA,MAAAA,gBAAAC,eAAAC,KAAA,SAAAC,QACA,MAAAA,QAAAC,QAGAC,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,WAKAV,MAAA,aACAC,IAAA,SACAC,YAAA,uBACAC,WAAA,YACAC,SACAC,SAAA,SAAAC,gBACA,MAAAA,gBAAAC,eAAAC,KAAA,SAAAC,QACA,MAAAA,QAAAC,QAGAC,KAAA,SAAAL,gBACA,MAAAA,gBAAAM,YAAAJ,KAAA,SAAAC,QACA,MAAAA,QAAAC,aAOAjB,eAAAwB,OAAA,UAAA,WACA,MAAA,UAAAC,OACA,MAAAA,OAAAC,QAAAC,aA1IAC,EAAAC,UAAAC,MAAA,WAEA,GAAAC,gBAAAC,SAAAJ,EAAA,YAAAK,SAAAC,IAEAN,GAAAC,UAAAM,aAAAJ,gBACAH,EAAA,YAAAQ,KACAC,SAAA,SACAH,IAAA,IACAI,UAAA,QAIAV,EAAAW,QAAAC,OAAA,WACAZ,EAAAC,UAAAM,aACAJ,eACAH,EAAA,YAAAQ,KACAC,SAAA,SACAH,IAAA,IACAI,UAAA,QAIAV,EAAA,YAAAQ,KACAC,SAAA,UACAC,UAAA,UCxBAtC,eAAAU,WAAA,aAAA,SAAA,SAAA,iBAAA,WAAA,OAAA,SACA,SAAA+B,OAAAC,OAAA7B,eAAAD,SAAAM,KAAAyB,QAEAF,OAAAG,SAAAhC,SACA6B,OAAAI,KAAA3B,KAEAuB,OAAAK,WAAA,WACAJ,OAAAK,GAAA,eAGAN,OAAAO,gBAAA,SAAAC,SACAP,OAAAK,GAAA,mBAAAxB,KAAA0B,QAAA1B,QAGAkB,OAAAS,cAAA,SAAAD,SACApC,eAAAqC,cAAAD,QAAAE,IAAApC,KAAA,WACA2B,OAAAU,YAIAX,OAAAY,UAAA,SAAAC,KACAzC,eAAA0C,UAAAD,IAAAH,IAAApC,KAAA,WACA2B,OAAAU,YAIAX,OAAAe,QAAA,WACA3C,eAAA4C,OAAAhB,OAAAa,KAAAvC,KAAA,WACA2B,OAAAU,YAIAX,OAAAiB,UAAA,SAAAC,MACAA,KAAAC,OAAAjB,OAAAiB,QACApD,IAAA,SACAqD,OAAA,OACAF,KAAAA,OAGAA,KAAAC,OAAA7C,KAAA,SAAA+C,UACAA,SAAA7C,KAAA8C,SACAtB,OAAAa,IAAAU,MAAAF,SAAA7C,KAAAgD,KACAxB,OAAAyB,YAAAC,IAGAC,QAAAC,IAAAP,WAEA,SAAAA,YACA,SAAAQ,KAEAX,KAAAY,SAAAC,KAAAC,IAAA,IAAAzC,SAAA,IAAAsC,IAAAI,OAAAJ,IAAAK,cClDA3E,eAAAU,WAAA,oBAAA,SAAA,SAAA,iBAAA,WAAA,OACA,SAAA+B,OAAAC,OAAA7B,eAAAD,SAAAM,MAEAuB,OAAAG,SAAAhC,SACA6B,OAAAI,KAAA3B,QCJAlB,eAAAU,WAAA,eAAA,SAAA,SAAA,SAAA,iBAAA,UAAA,OACA,SAAA+B,OAAAC,OAAAC,OAAA9B,eAAAO,QAAAF,MAGAuB,OAAAQ,QAAA7B,UAAAwD,gBAAA/B,SACAJ,OAAAI,KAAA3B,KACAuB,OAAAoC,iBAAApC,OAAAQ,QAAA2B,aAAAE,MAEA,IAAAzC,UAAA,CAEAI,QAAAsC,YAAA,GACAtC,OAAAuC,eAGAvC,OAAAwC,OADA7D,QACAA,QAAA6D,UAMAxC,OAAAyC,WAAA,SAAAC,QAAAC,QAAAC,KACA,SAAAF,UACA1C,OAAAwC,OAAAK,MAAAC,KAAA,QAAAlD,SAAAgD,KAAAhD,SAAA+C,QAAAA,UACA3C,OAAAQ,QAAAuC,MAAAJ,SAEA,UAAAD,SACA1C,OAAAwC,OAAAK,MAAAC,KAAA,SAAAlD,SAAAgD,KAAAhD,SAAA+C,QAAAA,UAEA,SAAAD,SACA1C,OAAAwC,OAAAK,MAAAC,KAAA,QAAAlD,SAAAgD,KAAAhD,SAAA+C,QAAAA,UAEA,WAAAD,SACA1C,OAAAwC,OAAAK,MAAAC,KAAA,UAAAlD,SAAAgD,KAAAhD,SAAA+C,QAAAA,UAEA,eAAAD,SACA1C,OAAAwC,OAAAK,MAAAC,KAAA,cAAAlD,SAAAgD,KAAAhD,SAAA+C,QAAAA,UAEA/C,WACAI,OAAAsC,YAAA,GACAtC,OAAAuC,eACAvC,OAAAgD,oBAAAtB,IAGA1B,OAAAiD,cAAA,SAAArD,UACAI,OAAAwC,OAAAU,OAAAtD,SAAA,IAGAI,OAAAmD,gBAAA,SAAAT,QAAAU,OACAC,yBACA,SAAAX,QAAAI,MAAA,SAAAJ,QAAAI,OACA9C,OAAAsC,YAAAI,QAAAC,QACA3C,OAAAwC,OAAAU,OAAAE,MAAA,GACApD,OAAAgD,gBAAAN,QAAA9C,UAEA,eAAA8C,QAAAI,MAAA,WAAAJ,QAAAI,OACA9C,OAAAuC,YAAAG,QAAAC,QACA3C,OAAAwC,OAAAU,OAAAE,MAAA,GACApD,OAAAgD,gBAAAN,QAAA9C,WAIAI,OAAAsD,cAAA,SAAA1D,UACA,GAAA2D,aAAAvD,OAAAwC,OAAA5C,UAAA,QACAI,QAAAwC,OAAA5C,UAAA,SAAAI,OAAAwC,SAAA5C,UAAA,SACAI,OAAAwC,OAAA5C,UAAA,SAAA2D,YACAF,0BAGArD,OAAAwD,iBAAA,SAAA5D,UACA,GAAA2D,aAAAvD,OAAAwC,OAAA5C,UAAA,QACAI,QAAAwC,OAAA5C,UAAA,SAAAI,OAAAwC,SAAA5C,UAAA,SACAI,OAAAwC,OAAA5C,UAAA,SAAA2D,YACAF,yBAGA,IAAAA,wBAAA,WACArD,OAAAwC,OAAAxC,OAAAwC,OAAAiB,KAAA,SAAAC,SAAAC,UACA,MAAAD,UAAA9D,SAAA+D,SAAA/D,UACA,EAGA,IAKAI,QAAA4D,eAAA,SAAAC,MACA,GAAAA,KAAAC,OAAA,CACA,GAAAC,cAAAC,OAAAhE,OAAAgE,OAAArB,QAAA3C,OAAA2C,QAAAsB,KAAAjE,OAAAiE,KAAAC,QAAAlE,OAAAkE,QAAAC,UAAAnE,OAAAQ,QAAAE,GACAtC,gBAAAgG,gBAAAL,aAAAzF,KAAA,WACA2B,OAAAU,aAKAX,OAAAqE,WAAA,WACA,GAAA7D,UAAAuC,MAAA/C,OAAAQ,QAAAuC,MAAAP,OAAAxC,OAAAwC,OACAxC,QAAAQ,QAAAE,KACAF,QAAAE,GAAAV,OAAAQ,QAAAE,IAEAtC,eAAAkG,YAAA9D,SAAAlC,KAAA,WACA2B,OAAAK,GAAA,WAIAN,OAAAS,cAAA,WACArC,eAAAqC,cAAAT,OAAAQ,QAAAE,IAAApC,KAAA,WACA2B,OAAAK,GAAA,WAIAN,OAAAuE,gBAAA,SAAA1D,KACAzC,eAAAmG,gBAAA1D,IAAAH,GAAAV,OAAAQ,QAAAE,IAAApC,KAAA,SAAA+C,UACArB,OAAAQ,QAAAJ,KAAAyC,KAAAhC,QAIAb,OAAAwE,qBAAA,SAAA3D,KACAzC,eAAAoG,qBAAA3D,IAAAH,GAAAV,OAAAQ,QAAAE,IAAApC,KAAA,SAAA+C,UACArB,OAAAQ,QAAAJ,KAAAqD,KAAA,SAAAgB,KAAAC,MACA,MAAAA,MAAAhE,IAAAG,IAAAH,KACAiE,WAIA3E,OAAAiB,UAAA,SAAAC,MACAA,KAAAC,OAAAjB,OAAAiB,QACApD,IAAA,SACAqD,OAAA,OACAF,KAAAA,OAGAA,KAAAC,OAAA7C,KAAA,SAAA+C,UACAA,SAAA7C,KAAA8C,UACAtB,OAAAyC,WAAA,SAAApB,SAAA7C,KAAAgD,MACAxB,OAAAyB,YAAAC,KAEA,SAAAL,YACA,SAAAQ,KAEAX,KAAAY,SAAAC,KAAAC,IAAA,IAAAzC,SAAA,IAAAsC,IAAAI,OAAAJ,IAAAK,WAIAlC,OAAA4E,iBAAA,SAAA/D,KACA,OAAAb,OAAAQ,QAAAJ,KAAAyE,KAAA,SAAAC,YACA,MAAAA,YAAApE,IAAAG,IAAAH,SClJAnD,eAAAwH,UAAA,iBAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAAC,SAAA,aACAnH,YAAA,oCCLAT,eAAAwH,UAAA,WAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAA3D,MAAA,UACA6D,SAAA,+DCLA7H,eAAAwH,UAAA,WAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAA3D,MAAA,UACA6D,SAAA,8DCLA7H,eAAAwH,UAAA,gBAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAAC,SAAA,aACAnH,YAAA,mCCLAT,eAAAwH,UAAA,YAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAAC,SAAA,aACAnH,YAAA,+BCLAT,eAAAwH,UAAA,UAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAAG,MAAA,UACAD,SAAA,oFCLA7H,eAAAwH,UAAA,UAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,OAAAnC,MAAA,UACAqC,SAAA,qDCLA7H,eAAA+H,QAAA,kBAAA,QAAA,SAAAC,OAEAC,KAAA3G,WAAA,SAAAC,MACA,MAAAyG,OAAAE,IAAA,qBAAA3G,OAGA0G,KAAAnH,aAAA,WACA,MAAAkH,OAAAE,IAAA,kBAGAD,KAAA9G,UAAA,WACA,MAAA6G,OAAAE,IAAA,eAGAD,KAAAlB,YAAA,SAAA9D,SACA,MAAA+E,OAAAG,KAAA,gBAAAlF,QAAAA,WAGAgF,KAAA/E,cAAA,SAAAC,IACA,MAAA6E,OAAAI,OAAA,qBAAAjF,KAGA8E,KAAApB,gBAAA,SAAAL,aACA,MAAAwB,OAAAG,KAAA,2BAAA3B,YAAAA,eAGAyB,KAAAxE,OAAA,SAAAH,KACA,MAAA0E,OAAAG,KAAA,WAAA7E,IAAAA,OAGA2E,KAAA1E,UAAA,SAAAD,KACA,MAAA0E,OAAAG,KAAA,aAAA7E,IAAAA,OAGA2E,KAAAjB,gBAAA,SAAA1D,IAAAL,SACA,MAAA+E,OAAAG,KAAA,oBAAA7E,IAAAA,IAAAL,QAAAA,WAGAgF,KAAAhB,qBAAA,SAAA3D,IAAAL,SACA,MAAA+E,OAAAG,KAAA,wBAAA7E,IAAAA,IAAAL,QAAAA","file":"main.js","sourcesContent":["// Define the `cookieStoryApp` module\nvar cookieStoryApp = angular.module('cookieStoryApp', ['ui.router', 'ngFileUpload']);\n\ncookieStoryApp.config(function($stateProvider, $urlRouterProvider) {\n\n    $urlRouterProvider.otherwise('/');\n\n    $stateProvider\n        // HOME STATES AND NESTED VIEWS ========================================\n        .state('home', {\n            url: '/',\n            templateUrl: 'views/home.html',\n            controller: 'ListeRecetteCtrl',\n            resolve: {\n              Recettes: function (RecetteService) {\n                return RecetteService.listeRecette().then(function (result) {\n                  return result.data;\n                });\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n        .state('recette', {\n            url: '/recette/{slug}',\n            templateUrl: 'views/recette.html',\n            controller: 'RecetteCtrl',\n            resolve: {\n              Recette: function ($stateParams, RecetteService) {\n                return RecetteService.getRecette($stateParams.slug).then(function siToutEstBon (result) {\n                  return result.data;\n                }, function siQqchPlante() {\n\n                }, function pendantQueLaRequeteEstTraitée() {\n\n                })\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n        .state('newRecette', {\n            url: '/recette',\n            templateUrl: 'views/add.recette.html',\n            controller: 'RecetteCtrl',\n            resolve: {\n              Recette: function () {\n                return null;\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n        .state('modifierRecette', {\n            url: '/modifRecette/{slug}',\n            templateUrl: 'views/add.recette.html',\n            controller: 'RecetteCtrl',\n            resolve: {\n              Recette: function ($stateParams, RecetteService) {\n                return RecetteService.getRecette($stateParams.slug).then(function siToutEstBon (result) {\n                  return result.data;\n                }, function siQqchPlante() {\n\n                }, function pendantQueLaRequeteEstTraitée() {\n\n                })\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n        .state('indexRecette', {\n            url: '/index',\n            templateUrl: 'views/index.html',\n            controller: 'ListeRecetteCtrl',\n            resolve: {\n              Recettes: function (RecetteService) {\n                return RecetteService.listeRecette().then(function (result) {\n                  return result.data;\n                });\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n        .state('categories', {\n            url: '/categories',\n            templateUrl: 'views/categories.html',\n            controller: 'ListeRecetteCtrl',\n            resolve: {\n              Recettes: function (RecetteService) {\n                return RecetteService.listeRecette().then(function (result) {\n                  return result.data;\n                });\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n        .state('pageAdmin', {\n            url: '/admin',\n            templateUrl: 'views/pageAdmin.html',\n            controller: 'adminCtrl',\n            resolve: {\n              Recettes: function (RecetteService) {\n                return RecetteService.listeRecette().then(function (result) {\n                  return result.data;\n                });\n              },\n              Tags: function (RecetteService) {\n                return RecetteService.listeTags().then(function (result) {\n                  return result.data;\n                });\n              },\n            }\n        })\n});\n\ncookieStoryApp.filter('reverse', function() {\n  return function(input) {\n    return input.slice().reverse();\n  };\n});\n","cookieStoryApp.controller('adminCtrl', ['$scope', '$state', 'RecetteService', 'Recettes', 'Tags', 'Upload',\n  function ($scope, $state, RecetteService, Recettes, Tags, Upload)\n{\n  $scope.recettes = Recettes;\n  $scope.tags = Tags;\n\n  $scope.newRecette = function () {\n    $state.go('newRecette');\n  }\n\n  $scope.modifierRecette = function (recette) {\n    $state.go('modifierRecette', {'slug': recette.slug});\n  }\n\n  $scope.deleteRecette = function (recette) {\n    RecetteService.deleteRecette(recette.id).then(function() {\n      $state.reload();\n    });\n  }\n\n  $scope.deleteTag = function (tag) {\n    RecetteService.removeTag(tag.id).then(function() {\n      $state.reload();\n    });\n  }\n\n  $scope.saveTag = function () {\n    RecetteService.addTag($scope.tag).then(function(){ // {nom: binding html, image: path après upload}\n      $state.reload();\n    })\n  }\n\n  $scope.uploadPic = function(file) {\n    file.upload = Upload.upload({\n      url: 'upload',\n      method: 'POST',\n      file: file,\n    });\n\n    file.upload.then(function (response) {\n        if (response.data.success) {\n          $scope.tag.image = response.data.path;\n          $scope.picFile=undefined;\n        }\n        else{\n          console.log(response);\n        }\n      }, function (response) {\n      }, function (evt) {\n        // Math.min is to fix IE which reports 200% sometimes\n        file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));\n      });\n    }\n\n}])\n","cookieStoryApp.controller('ListeRecetteCtrl', ['$scope', '$state', 'RecetteService', 'Recettes', 'Tags',\n  function ($scope, $state, RecetteService, Recettes, Tags)\n{\n  $scope.recettes = Recettes;\n  $scope.tags = Tags;\n\n}])\n","cookieStoryApp.controller('RecetteCtrl', ['$scope', '$state', 'Upload', 'RecetteService', 'Recette', 'Tags',\n  function ($scope, $state, Upload, RecetteService, Recette, Tags)\n{\n\n  $scope.recette = Recette || {commentaires:[], tags:[]};\n  $scope.tags = Tags;\n  $scope.countCommentaire = $scope.recette.commentaires.length;\n\n  var position = 1;\n\n  $scope.contenuText='';\n  $scope.contenuList = [];\n\nif (Recette){\n  $scope.layout=Recette.layout;\n}\nelse{\n  $scope.layout = [];\n}\n\n  $scope.addElement = function (element, contenu, pos) {\n    if (element == 'titre') {\n      $scope.layout.push({item:'titre', position:pos ? pos : position, contenu:contenu})\n      $scope.recette.titre = contenu;\n    }\n    if (element == 'imageH') {\n      $scope.layout.push({item:'imageH', position:pos ? pos : position, contenu:contenu})\n    }\n    if (element == 'story') {\n      $scope.layout.push({item:'story', position:pos ? pos : position, contenu:contenu})\n    }\n    if (element == 'recette') {\n      $scope.layout.push({item:'recette', position:pos ? pos : position, contenu:contenu})\n    }\n    if (element == 'ingredients') {\n      $scope.layout.push({item:'ingredients', position:pos ? pos : position, contenu:contenu})\n    }\n    position++;\n    $scope.contenuText='';\n    $scope.contenuList = [];\n    $scope.positionEdition = undefined;\n  }\n\n  $scope.deleteElement = function (position) {\n    $scope.layout.splice(position, 1);\n  }\n\n  $scope.modifierElement = function (element, index) {\n    trierLayoutParPosition();\n    if (element.item == 'titre' || element.item =='story') {\n      $scope.contenuText = element.contenu;\n      $scope.layout.splice(index, 1);\n      $scope.positionEdition = element.position;\n    }\n    if (element.item == 'ingredients' || element.item =='recette') {\n      $scope.contenuList = element.contenu;\n      $scope.layout.splice(index, 1);\n      $scope.positionEdition = element.position;\n    }\n  }\n\n  $scope.monterElement = function (position) {\n    var positionTmp = $scope.layout[position]['position'];\n    $scope.layout[position]['position'] = $scope.layout[--position]['position'];\n    $scope.layout[position]['position'] = positionTmp;\n    trierLayoutParPosition();\n  }\n\n  $scope.descendreElement = function (position) {\n    var positionTmp = $scope.layout[position]['position'];\n    $scope.layout[position]['position'] = $scope.layout[++position]['position'];\n    $scope.layout[position]['position'] = positionTmp;\n    trierLayoutParPosition();\n  }\n\n  var trierLayoutParPosition = function () {\n    $scope.layout = $scope.layout.sort(function (elementA, elementB) {\n      if (elementA.position < elementB.position) {\n        return -1;\n      }\n      else {\n        return 1;\n      }\n    })\n  }\n\n  $scope.addCommentaire = function (form){\n    if (form.$valid) {\n      var commentaire = {pseudo:$scope.pseudo, contenu:$scope.contenu, mail:$scope.mail, website:$scope.website, recetteId:$scope.recette.id}\n      RecetteService.saveCommentaire(commentaire).then(function(){\n        $state.reload();\n      });\n    }\n  }\n\n  $scope.addRecette = function () {\n    var recette = {titre:$scope.recette.titre, layout:$scope.layout}\n    if ($scope.recette.id) {\n      recette.id = $scope.recette.id;\n    }\n    RecetteService.saveRecette(recette).then(function () {\n      $state.go('home');\n    });\n  }\n\n  $scope.deleteRecette = function () {\n    RecetteService.deleteRecette($scope.recette.id).then(function() {\n      $state.go('home');\n    });\n  }\n\n  $scope.addTagToRecette = function (tag) {\n      RecetteService.addTagToRecette(tag.id, $scope.recette.id).then(function (response) {\n          $scope.recette.tags.push(tag);\n      });\n  }\n\n  $scope.removeTagFromRecette = function (tag) {\n      RecetteService.removeTagFromRecette(tag.id, $scope.recette.id).then(function (response) {\n        $scope.recette.tags.sort(function (tagA, tagB) {\n          return tagB.id == tag.id\n        }).shift();\n      });\n  }\n\n  $scope.uploadPic = function(file) {\n    file.upload = Upload.upload({\n      url: 'upload',\n      method: 'POST',\n      file: file,\n    });\n\n    file.upload.then(function (response) {\n        if (response.data.success) {\n          $scope.addElement(\"imageH\", response.data.path)\n          $scope.picFile=undefined;\n        }\n      }, function (response) {\n      }, function (evt) {\n        // Math.min is to fix IE which reports 200% sometimes\n        file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));\n      });\n    }\n\n    $scope.isNotSelectedTag = function (tag) {\n      return !$scope.recette.tags.some(function (tagRecette) {\n        return tagRecette.id == tag.id;\n      })\n    }\n}])\n","cookieStoryApp.directive('csCommentaires', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {elements: '=elements'},\n        templateUrl: 'js/templates/commentaires.html'\n  }\n});\n","cookieStoryApp.directive('csImageH', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {image: '=image'},\n      template: \"<div class='col-xs-12'><img ng-src={{image}}></img></div>\"\n  }\n});\n","cookieStoryApp.directive('csImageV', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {image: '=image'},\n      template: \"<div class='col-xs-6'><img ng-src={{image}}></img></div>\"\n  }\n});\n","cookieStoryApp.directive('csIngredients', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {elements: '=elements'},\n        templateUrl: 'js/templates/ingredients.html'\n  }\n});\n","cookieStoryApp.directive('csRecette', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {elements: '=elements'},\n      templateUrl: 'js/templates/recette.html'\n  }\n});\n","cookieStoryApp.directive('csStory', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {story: '=story'},\n      template: \"<div class='col-xs-12'><h2>Il etait une fois...</h2>\" +\n      \"<div>{{story}}</div></div>\"\n  }\n});\n","cookieStoryApp.directive('csTitre', function () {\n  return {\n      restrict: 'EC',\n      replace: true,\n      scope: {titre: '=titre'},\n      template: \"<div class='col-xs-12'><h1>{{titre}}</h1></div>\"\n  }\n});\n","cookieStoryApp.service('RecetteService', ['$http', function ($http) {\n\n  this.getRecette = function (slug) {\n    return $http.get('recette/find?slug='+slug);\n  }\n\n  this.listeRecette = function () {\n    return $http.get('recette/liste');\n  }\n\n  this.listeTags = function () {\n    return $http.get('tags/liste');\n  }\n\n  this.saveRecette = function (recette) {\n    return $http.post('recette/save', {'recette':recette});\n  }\n\n  this.deleteRecette = function (id) {\n    return $http.delete('recette/delete?id='+id);\n  }\n\n  this.saveCommentaire = function (commentaire) {\n    return $http.post('recette/saveCommentaire', {'commentaire':commentaire});\n  }\n\n  this.addTag = function (tag){\n    return $http.post('saveTag',{'tag':tag});\n  }\n\n  this.removeTag = function (tag){\n    return $http.post('removeTag',{'tag':tag});\n  }\n\n  this.addTagToRecette = function (tag, recette){\n    return $http.post('saveTagToRecette',{'tag':tag, 'recette':recette});\n  }\n\n  this.removeTagFromRecette = function (tag, recette){\n    return $http.post('removeTagFromRecette',{'tag':tag, 'recette':recette});\n  }\n}])\n"],"sourceRoot":"/source/"}